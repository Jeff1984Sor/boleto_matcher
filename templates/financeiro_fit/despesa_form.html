{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="max-w-4xl mx-auto pb-24 px-4">
    <!-- HEADER -->
    <header class="flex justify-between items-center mb-10">
        <div class="flex items-center gap-6">
            <div class="w-16 h-16 bg-primary rounded-[22px] flex items-center justify-center text-white shadow-xl border-2 border-white">
                <i class="fas fa-file-invoice-dollar text-2xl"></i>
            </div>
            <div>
                <h1 class="text-3xl font-black text-slate-800 tracking-tighter uppercase italic">Nova Despesa</h1>
                <p class="text-[10px] text-primary font-black uppercase tracking-[3px] mt-1">Gestão de Saídas e Custos</p>
            </div>
        </div>
    </header>

    <form method="post" enctype="multipart/form-data" class="space-y-8 animate-in slide-in-from-bottom-6 duration-700">
        {% csrf_token %}

        <!-- BLOCO 1: IDENTIFICAÇÃO -->
        <div class="bg-white rounded-[3.5rem] shadow-2xl p-12 border border-slate-50">
            <div class="grid grid-cols-1 md:grid-cols-12 gap-8">
                <div class="md:col-span-8 flex flex-col gap-2">
                    <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-4">Descrição*</label>
                    <input type="text" name="descricao" class="input input-bordered rounded-2xl bg-slate-50 border-none font-bold h-14 w-full" required>
                </div>

                <div class="md:col-span-4 flex flex-col gap-2">
                    <label class="text-[10px] font-black text-primary uppercase tracking-widest ml-4">Valor R$*</label>
                    <input type="number" step="0.01" name="valor" class="input input-bordered rounded-2xl bg-primary/5 border-none font-black text-primary text-xl h-14 w-full" required>
                </div>

                <div class="md:col-span-6 flex flex-col gap-2">
                    <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-4">Fornecedor</label>
                    <select name="fornecedor" class="select select-bordered rounded-2xl bg-slate-50 border-none font-bold h-14 w-full">
                        <option value="">Selecione...</option>
                        {% for f in fornecedores %}
                            <option value="{{ f.id }}">{{ f.nome }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="md:col-span-6 flex flex-col gap-2">
                    <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-4">Categoria / Plano de Contas*</label>
                    <select name="categoria" class="select select-bordered rounded-2xl bg-slate-50 border-none font-bold h-14 w-full" required>
                        <option value="">Selecione...</option>
                        {% for c in categorias %}
                            <option value="{{ c.id }}">{{ c.nome }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="md:col-span-6 flex flex-col gap-2">
                    <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-4">Vencimento*</label>
                    <input type="date" name="data_vencimento" value="{% now 'Y-m-d' %}" class="input input-bordered rounded-2xl bg-slate-50 border-none font-bold h-14 w-full" required>
                </div>

                <div class="md:col-span-6 flex flex-col gap-2">
                    <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-4">Conta de Saída*</label>
                    <select name="conta" class="select select-bordered rounded-2xl bg-slate-50 border-none font-bold h-14 w-full" required>
                        {% for conta in contas %}
                            <option value="{{ conta.id }}">{{ conta.nome }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>

        <!-- BLOCO 2: RECORRÊNCIA DINÂMICA -->
        <div class="bg-slate-900 rounded-[3rem] p-10 shadow-xl border border-slate-800 transition-all duration-500">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-6">
                    <div class="w-14 h-14 bg-white/5 rounded-2xl flex items-center justify-center text-primary"><i class="fas fa-arrows-rotate text-xl"></i></div>
                    <div>
                        <h4 class="text-white font-black uppercase tracking-[2px] text-sm italic">Recorrência Programada</h4>
                        <p class="text-slate-500 text-[10px] font-bold uppercase tracking-widest">Repetir esta despesa?</p>
                    </div>
                </div>
                <input type="checkbox" name="repetir" id="id_repetir" class="toggle toggle-primary toggle-lg" onchange="document.getElementById('painel-recorrencia').classList.toggle('hidden')">
            </div>

            <!-- OPÇÕES QUE APARECEM AO CLICAR -->
            <div id="painel-recorrencia" class="hidden mt-10 pt-10 border-t border-white/5 animate-in slide-in-from-top-2">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="flex flex-col gap-2">
                        <label class="text-[9px] font-black text-slate-500 uppercase tracking-[2px] ml-4">Frequência</label>
                        <select name="frequencia" class="select bg-white/5 border-none rounded-2xl text-white font-black h-14">
                            <option value="MENSAL">MENSAL</option>
                            <option value="SEMANAL">SEMANAL</option>
                            <option value="ANUAL">ANUAL</option>
                        </select>
                    </div>
                    <div class="flex flex-col gap-2">
                        <label class="text-[9px] font-black text-slate-500 uppercase tracking-[2px] ml-4">Número de Parcelas</label>
                        <input type="number" name="total_parcelas" value="2" min="2" class="input bg-white/5 border-none rounded-2xl text-white font-black h-14">
                    </div>
                </div>
            </div>
        </div>

        <!-- BLOCO 3: STATUS -->
        <div class="bg-white rounded-[3.5rem] shadow-2xl p-12 border border-slate-50">
            <div class="flex flex-col gap-2">
                <label class="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-4">Situação Inicial*</label>
                <select name="status" class="select select-bordered rounded-2xl bg-slate-50 border-none font-black h-14 w-full">
                    <option value="PENDENTE">Aguardando Pagamento</option>
                    <option value="PAGO">Já Pago (Liquidado)</option>
                </select>
            </div>
        </div>

        <button type="submit" class="btn bg-primary hover:bg-red-900 border-none text-white rounded-[2rem] w-full h-20 shadow-2xl shadow-primary/30 font-black uppercase tracking-[3px] italic transition-all hover:scale-[1.01]">
            SALVAR LANÇAMENTO
        </button>
    </form>
</div>
{% endblock %}